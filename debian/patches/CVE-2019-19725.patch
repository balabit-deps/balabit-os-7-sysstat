From a5c8abd4a481ee6e27a3acf00e6d9b0f023e20ed Mon Sep 17 00:00:00 2001
From: Sebastien GODARD <sysstat@users.noreply.github.com>
Date: Mon, 9 Dec 2019 17:54:07 +0100
Subject: [PATCH] Fix #242: Double free in check_file_actlst()

Avoid freeing buffer() twice.

Signed-off-by: Sebastien GODARD <sysstat@users.noreply.github.com>
Index: sysstat-11.6.1/sa_common.c
===================================================================
--- sysstat-11.6.1.orig/sa_common.c
+++ sysstat-11.6.1/sa_common.c
@@ -1280,6 +1280,7 @@ void check_file_actlst(int *ifd, char *d
 	 */
 	memcpy(file_hdr, buffer, FILE_HEADER_SIZE);
 	free(buffer);
+	buffer = NULL;
 
 	/*
 	 * Sanity check.
